(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{188:function(t,e,a){"use strict";a.r(e);var s=a(0),r=Object(s.a)({},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"etcd集群安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#etcd集群安装","aria-hidden":"true"}},[t._v("#")]),t._v(" etcd集群安装")]),t._v(" "),a("h2",{attrs:{id:"_1-部署环境三台机子："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-部署环境三台机子：","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.部署环境三台机子：")]),t._v(" "),a("ul",[a("li",[t._v("192.168.245.20")]),t._v(" "),a("li",[t._v("192.168.245.21")]),t._v(" "),a("li",[t._v("192.168.245.22")])]),t._v(" "),a("h2",{attrs:{id:"_2-下载并解压"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-下载并解压","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.下载并解压")]),t._v(" "),a("pre",[a("code",[t._v("wget https://github.com/etcd-io/etcd/releases/download/v3.3.12/etcd-v3.3.12-linux-amd64.tar.gz\n\ntar -zxvf etcd-v3.3.12-linux-amd64.tar.gz\n")])]),t._v(" "),a("h2",{attrs:{id:"_3-将etcd和etcdctl拷贝到-usr-bin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-将etcd和etcdctl拷贝到-usr-bin","aria-hidden":"true"}},[t._v("#")]),t._v(" 3.将etcd和etcdctl拷贝到/usr/bin")]),t._v(" "),a("pre",[a("code",[t._v("cp etcd etcdctl /usr/bin\n")])]),t._v(" "),a("h2",{attrs:{id:"_4-创建文件夹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-创建文件夹","aria-hidden":"true"}},[t._v("#")]),t._v(" 4.创建文件夹")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("mkdir -p /usr/local/k8s/conf\nmkdir -p /var/lib/etcd\n")])])]),a("h2",{attrs:{id:"_5-配置信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-配置信息","aria-hidden":"true"}},[t._v("#")]),t._v(" 5.配置信息")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("vi /usr/lib/systemd/system/etcd.service\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('[Unit]\nDescription=Etcd Server\nAfter=network.target\nAfter=network-online.target\nWants=network-online.target\n\n[Service]\nType=notify\nWorkingDirectory=/var/lib/etcd\nEnvironmentFile=-/usr/local/k8s/conf/etcd.conf\nExecStart=/bin/bash -c "GOMAXPROCS=$(nproc) /usr/bin/etcd --name=\\"${ETCD_NAME}\\" --data-dir=\\"${ETCD_DATA_DIR}\\" --listen-peer-urls=\\"${ETCD_LISTEN_PEER_URLS}\\" --listen-client-urls=\\"${ETCD_LISTEN_CLIENT_URLS}\\" --advertise-client-urls=\\"${ETCD_ADVERTISE_CLIENT_URLS}\\" --initial-advertise-peer-urls=\\"${ETCD_INITIAL_ADVERTISE_PEER_URLS}\\" --initial-cluster=\\"${ETCD_INITIAL_CLUSTER}\\" --initial-cluster-token=\\"${ETCD_INITIAL_CLUSTER_TOKEN}\\" --initial-cluster-state=\\"${ETCD_INITIAL_CLUSTER_STATE}\\""\nRestart=on-failure\nLimitNOFILE=65536\n\n[Install]\nWantedBy=multi-user.target\n')])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("vi /usr/local/k8s/conf/etcd.conf \n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('#[member]\nETCD_NAME="etcd1"                                          \nETCD_DATA_DIR="/var/lib/etcd/etcd1"\nETCD_LISTEN_PEER_URLS="http://192.168.245.20:2380"\nETCD_LISTEN_CLIENT_URLS="http://0.0.0.0:2379"\n\n#[cluster]\nETCD_INITIAL_ADVERTISE_PEER_URLS="http://192.168.245.20:2380"     \nETCD_INITIAL_CLUSTER="etcd1=http://192.168.245.20:2380,etcd2=http://192.168.245.21:2380,etcd3=http://192.168.245.22:2380"    \nETCD_INITIAL_CLUSTER_STATE="new"\nETCD_INITIAL_CLUSTER_TOKEN="k8s-etcd-cluster"\nETCD_ADVERTISE_CLIENT_URLS="http://0.0.0.0:2379"  \n')])])]),a("h2",{attrs:{id:"_6-启动etcd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-启动etcd","aria-hidden":"true"}},[t._v("#")]),t._v(" 6.启动etcd")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("systemctl daemon-reload\nsystemctl enable etcd\nsystemctl start etcd\nsystemctl restart etcd\n")])])]),a("h2",{attrs:{id:"_7-检查集群"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-检查集群","aria-hidden":"true"}},[t._v("#")]),t._v(" 7.检查集群")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("etcdctl member list\netcdctl cluster-health\n")])])])])},[],!1,null,null,null);e.default=r.exports}}]);