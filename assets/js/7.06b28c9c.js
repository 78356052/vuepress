(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{190:function(e,t,r){"use strict";r.r(t);var s=r(0),a=Object(s.a)({},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"k8s-master节点搭建"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#k8s-master节点搭建","aria-hidden":"true"}},[e._v("#")]),e._v(" k8s master节点搭建")]),e._v(" "),r("h2",{attrs:{id:"_1-前期准备"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-前期准备","aria-hidden":"true"}},[e._v("#")]),e._v(" 1.前期准备")]),e._v(" "),r("h4",{attrs:{id:"a-准备3台虚拟机"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#a-准备3台虚拟机","aria-hidden":"true"}},[e._v("#")]),e._v(" a.准备3台虚拟机")]),e._v(" "),r("ul",[r("li",[e._v("192.168.245.20    master")]),e._v(" "),r("li",[e._v("192.168.245.21    node1")]),e._v(" "),r("li",[e._v("192.168.245.22    node2")])]),e._v(" "),r("h4",{attrs:{id:"b-配置静态ip及重启网络"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#b-配置静态ip及重启网络","aria-hidden":"true"}},[e._v("#")]),e._v(" b.配置静态IP及重启网络")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("vi /etc/sysconfig/network-scripts/ifcfg-ens33\n\nBOOTPROTO=static\nIPADDR=192.168.245.22\nNETMASK=255.255.255.0\nGATEWAY=192.168.245.2\nDNS1=192.168.245.2\nONBOOT=yes\n\nservice network restart #重新启动网络\n\nyum install net-tools.x86_64 -y  #安装 ifconfig 管理命令\n")])])]),r("h4",{attrs:{id:"c-vi-etc-selinux-config"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#c-vi-etc-selinux-config","aria-hidden":"true"}},[e._v("#")]),e._v(" c."),r("code",[e._v("vi /etc/selinux/config")])]),e._v(" "),r("pre",[r("code",[e._v("SELINUX=enforcing设置成SELINUX=disabled\n")])]),e._v(" "),r("h4",{attrs:{id:"d-vi-etc-fstab"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#d-vi-etc-fstab","aria-hidden":"true"}},[e._v("#")]),e._v(" d."),r("code",[e._v("vi /etc/fstab")])]),e._v(" "),r("pre",[r("code",[e._v("注释/dev/mapper/centos-swap swap  swap  defaults  0 0\n")])]),e._v(" "),r("h4",{attrs:{id:"e-关闭防火墙"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#e-关闭防火墙","aria-hidden":"true"}},[e._v("#")]),e._v(" e.关闭防火墙")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("systemctl stop firewalld\nsystemctl disable firewalld\n")])])]),r("h4",{attrs:{id:"f-vi-etc-hosts"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#f-vi-etc-hosts","aria-hidden":"true"}},[e._v("#")]),e._v(" f."),r("code",[e._v("vi /etc/hosts")])]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("192.168.245.20 matser\n192.168.245.21 node1\n192.168.245.22 node2\n")])])]),r("h2",{attrs:{id:"_2-下载并解压kubernetes"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-下载并解压kubernetes","aria-hidden":"true"}},[e._v("#")]),e._v(" 2.下载并解压kubernetes")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("wget https://dl.k8s.io/v1.15.1/kubernetes-server-linux-amd64.tar.gz\ntar -zxvf kubernetes-server-linux-amd64.tar.gz\n")])])]),r("h2",{attrs:{id:"_3-把相关命令拷贝到环境变量目录下"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-把相关命令拷贝到环境变量目录下","aria-hidden":"true"}},[e._v("#")]),e._v(" 3.把相关命令拷贝到环境变量目录下")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("cp kube-apiserver kube-controller-manager kube-scheduler /usr/bin/\n")])])]),r("h2",{attrs:{id:"_4-安装kube-apiserver"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-安装kube-apiserver","aria-hidden":"true"}},[e._v("#")]),e._v(" 4.安装kube-apiserver")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('mkdir -p /usr/local/k8s/conf/\nvi /usr/lib/systemd/system/kube-apiserver.service\n\n[Unit]\nDescription=Kubernetes API Server\nDocumentation=https://github.com/kubernetes/kubernetes\n[Service]\nEnvironmentFile=-/usr/local/k8s/conf/kube-apiserver\nExecStart=/usr/bin/kube-apiserver \\\n${KUBE_LOGTOSTDERR} \\\n${KUBE_LOG_LEVEL} \\\n${KUBE_ETCD_SERVERS} \\\n${KUBE_API_ADDRESS} \\\n${KUBE_API_PORT} \\\n${KUBE_ADVERTISE_ADDR} \\\n${KUBE_ALLOW_PRIV} \\\n${KUBE_SERVICE_ADDRESSES}\nRestart=on-failure\n[Install]\nWantedBy=multi-user.target\n\nvi /usr/local/k8s/conf/kube-apiserver\n\n#启用日志标准错误\nKUBE_LOGTOSTDERR="--logtostderr=true"\n#日志级别\nKUBE_LOG_LEVEL="--v=4"\n#Etcd服务地址\nKUBE_ETCD_SERVERS="--etcd-servers=http://192.168.245.20:2379,http://192.168.245.21:2379,http://192.168.245.22:2379"\n#API服务监听地址\nKUBE_API_ADDRESS="--insecure-bind-address=0.0.0.0"\n#API服务监听端口\nKUBE_API_PORT="--insecure-port=8080"\n#对集群中成员提供API服务地址\nKUBE_ADVERTISE_ADDR="--advertise-address=0.0.0.0"\n#允许容器请求特权模式，默认false\nKUBE_ALLOW_PRIV="--allow-privileged=false"\n#集群分配的IP范围，自定义但是要跟后面的kubelet（服务节点）的配置DNS在一个区间\nKUBE_SERVICE_ADDRESSES="--service-cluster-ip-range=10.0.0.0/24" \n\nsystemctl enable kube-apiserver  #加入开机自动启动\nsystemctl start kube-apiserver  #启动服务\n')])])]),r("h2",{attrs:{id:"_5-安装kube-controller-manager"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_5-安装kube-controller-manager","aria-hidden":"true"}},[e._v("#")]),e._v(" 5.安装kube-controller-manager")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('vi /usr/lib/systemd/system/kube-controller-manager.service\n\n[Unit]\nDescription=Kubernetes Controller Manager\nDocumentation=https://github.com/kubernetes/kubernetes\nAfter=kube-apiserver.service\nRequires=kube-apiserver.service\n[Service]\nEnvironmentFile=-/usr/local/k8s/conf/kube-controller-manager\nExecStart=/usr/bin/kube-controller-manager \\\n${KUBE_LOGTOSTDERR} \\\n${KUBE_LOG_LEVEL} \\\n${KUBE_MASTER} \\\n${KUBE_LEADER_ELECT}\nRestart=on-failure\n[Install]\nWantedBy=multi-user.target\n\nvi /usr/local/k8s/conf/kube-controller-manager \n\nKUBE_LOGTOSTDERR="--logtostderr=true"\nKUBE_LOG_LEVEL="--v=4"\nKUBE_MASTER="--master=192.168.245.20:8080"\n\nsystemctl enable kube-controller-manager  #加入开机自动启动\nsystemctl start kube-controller-manager  #启动服务\n')])])]),r("h2",{attrs:{id:"_6-安装kube-scheduler"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_6-安装kube-scheduler","aria-hidden":"true"}},[e._v("#")]),e._v(" 6.安装kube-scheduler")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('vi /usr/lib/systemd/system/kube-scheduler.service\n\n[Unit]\nDescription=Kubernetes Scheduler\nDocumentation=https://github.com/kubernetes/kubernetes\nAfter=kube-apiserver.service\nRequires=kube-apiserver.service\n[Service]\nEnvironmentFile=-/usr/local/k8s/conf/kube-scheduler\nExecStart=/usr/bin/kube-scheduler \\\n${KUBE_LOGTOSTDERR} \\\n${KUBE_LOG_LEVEL} \\\n${KUBE_MASTER} \\\n${KUBE_LEADER_ELECT}\nRestart=on-failure\n[Install]\nWantedBy=multi-user.target\n\nvi /usr/local/k8s/conf/kube-scheduler \n\nKUBE_LOGTOSTDERR="--logtostderr=true"\nKUBE_LOG_LEVEL="--v=4"\nKUBE_MASTER="--master=192.168.245.20:8080"\nKUBE_LEADER_ELECT="--leader-elect"\n\nsystemctl enable kube-scheduler  #加入开机自动启动\nsystemctl start kube-scheduler  #启动服务\n')])])])])},[],!1,null,null,null);t.default=a.exports}}]);